!function(){define("config",[],function(){"use strict";var a={},b="http://device-lab.appspot.com";return a.getRootUrl=function(){return b},a}),define("strings",[],function(){"use strict";var a={};return a.welcome_title="Welcome to Your<br />Device Lab",a.welcome_msgs=["Ever wanted to launch a url on a number of devices?","Well set-up your device lab and you'll be good to go."],a.sign_in="Sign In",a.device_list_loading_title="Just getting the devices in your lab..",a.device_list_title="Device Lab",a.no_device_msgs=["Oops, no devices in this lab.","Install the device lab on your Android and iPhone apps, sign in with the same Google account as this Chrome App and check back :)"],a.play_store="Google Play",a.app_store="App Store",a.launch_btn="Launch",a}),define("gplus-identity",["strings"],function(a){"use strict";function b(a,b,d){return function(e){c(e,a,b,d)}}function c(a,b,c,d){a.access_token?b(a.id_token,g):"immediate_failed"===a.error?(g=!1,d()):a.error&&(g=!1,c(a.error))}function d(a,b){b(a)}var e={},f="148156526883-75soacsqseft7npagv6226t9pg0vtbel.apps.googleusercontent.com",g=!0;return e.getUserInfo=function(a,b){this.performUserInfoRequest(!1,a,b)},e.performUserInfoRequest=function(a,b,c){console.log("MockIdentity.prototype.performUserInfoRequest "),d({userId:-1},b,c)},e.isLoggedIn=function(){return!1},e.addSignInButton=function(c,d,e,g){var h=document.createElement("span");h.appendChild(document.createTextNode(a.sign_in));var i=document.createElement("img");i.src="./images/g-plus-logo.png";var j=document.createElement("span");j.classList.add("sign-in-button"),j.appendChild(i),j.appendChild(h),j.href="#signin",c.appendChild(j),gapi.signin.render(j,{clientid:f,cookiepolicy:"single_host_origin",scope:"https://www.googleapis.com/auth/plus.login",callback:b(d,e,g)})},e}),define("device-list-controller",["config"],function(a){"use strict";function b(b,c,d){var e=new XMLHttpRequest;e.open("POST",a.getRootUrl()+"/devicelab/devices/get/",!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.onreadystatechange=function(){if(4==this.readyState){if(200!=this.status)return d(),void 0;var a=JSON.parse(e.responseText);c(a.devices)}};var f="id_token="+encodeURIComponent(b);e.send(f)}var c={};return c.getDevices=function(a,c,d){b(a,c,d)},c}),define("gcm-controller",["config"],function(a){"use strict";var b={};return b.sendUrlPushMessage=function(b,c,d,e){console.log("gcm-controller: sendPushMessageUrl() url = "+c);var f=new XMLHttpRequest;f.open("POST",a.getRootUrl()+"/devicelab/pushmsg/url/",!0),f.setRequestHeader("Content-Type","application/json"),f.onreadystatechange=function(){if(console.log("gcm-controller: sendPushMessageUrl() onreadystatechange"),4==this.readyState){if(console.log("gcm-controller: sendPushMessageUrl() readyState == 4"),200!=this.status)return console.log("gcm-controller: sendPushMessageUrl() error() "+f.responseText),void 0;console.log("gcm-controller: sendPushMessageUrl() xhr.responseText = "+f.responseText)}};for(var g=[],h=0;h<d.length;h++)g[h]=d[h].id;var i={id_token:b,url:c,browser_options:e,devices:g},j=JSON.stringify(i);f.send(j)},b}),define("android-browser-model",[],function(){"use strict";function a(){return 0}var b={},c=a();if(Modernizr&&Modernizr.localstorage){var d=localStorage.getItem("selected-browser");d&&(c=d)}var e="images/browser-icons/android/",f=[{name:"Chrome",icon:e+"chrome-icon.png",pkg:"com.android.chrome"},{name:"Chrome Beta",icon:e+"chrome-beta-icon.png",pkg:"com.chrome.beta"},{name:"Firefox",icon:e+"firefox-icon.png",pkg:"org.mozilla.firefox"},{name:"Firefox Beta",icon:e+"firefox-beta-icon.png",pkg:"org.mozilla.firefox_beta"},{name:"Opera",icon:e+"opera-icon.png",pkg:"com.opera.browser"},{name:"Opera Beta",icon:e+"opera-beta-icon.png",pkg:"com.opera.browser.beta"},{name:"Opera Mini",icon:e+"opera-mini-icon.png",pkg:"com.opera.mini.android"},{name:"Opera Classic",icon:e+"opera-classic-icon.png",pkg:"com.opera.browser.classic"}];return c>=f.length&&(c=0),b.getSupportedBrowsers=function(){return f},b.getSelectedBrowser=function(){return parseInt(c)},b.setSelectedBrowser=function(a){c=parseInt(a),Modernizr&&Modernizr.localstorage&&localStorage.setItem("selected-browser",a)},b}),define("home-ui-controller",["config","strings","device-list-controller","gcm-controller","android-browser-model"],function(a,b,c,d,e){"use strict";function f(){for(var a=q.firstChild;a;)q.removeChild(a),a=q.firstChild;var b=g(l);null!=b&&q.classList.remove(b)}function g(a){switch(a){case n:return"loading";case o:return"device-lab-home";default:return null}}function h(a,c){var f=document.createElement("header"),g=document.createElement("h1");if(g.innerHTML=a,f.appendChild(g),c===o&&r.length>0){var h=document.createElement("div");h.classList.add("search-container");var i=document.createElement("input");i.id="url-input",i.type="url",i.size=35,i.onkeyup=function(){Modernizr&&Modernizr.localstorage&&localStorage.setItem("url-input-field",i.value)},Modernizr&&Modernizr.localstorage&&(i.value=localStorage.getItem("url-input-field"));var j=document.createElement("a");j.appendChild(document.createTextNode(b.launch_btn)),j.onclick=function(a){a.preventDefault();var b=document.getElementById("url-input");if("undefined"!=typeof b){var c=b.value;if(null!==c&&0!==c.length){var f=[{platform:0,pkg:e.getSupportedBrowsers()[e.getSelectedBrowser()].pkg}];d.sendUrlPushMessage(m,c,r,f)}}},h.appendChild(i),h.appendChild(j),f.appendChild(h)}return f}function i(){var a=document.createElement("section");a.classList.add("device-heading");var b=document.createElement("h1");b.appendChild(document.createTextNode("Android")),a.appendChild(b);var c=document.createElement("ul");c.classList.add("browser-options");for(var d=e.getSupportedBrowsers(),f=e.getSelectedBrowser(),g=0;g<d.length;g++){var h=document.createElement("li"),i=document.createElement("img");i.src=d[g].icon;var k=document.createElement("p");k.appendChild(document.createTextNode(d[g].name)),h.appendChild(i),h.appendChild(k),g===f&&h.classList.add("selected-browser"),h.onclick=j(g),c.appendChild(h)}return a.appendChild(c),a}function j(a){return function(){for(var b=document.querySelector(".browser-options"),c=b.querySelectorAll(".selected-browser"),d=0;d<c.length;d++)c[d].classList.remove("selected-browser");b.children[a].classList.add("selected-browser"),e.setSelectedBrowser(a)}}function k(a){if(l!=a){f();var c,d=g(a);switch(a){case n:s||q.appendChild(h(b.device_list_loading_title,a)),c=document.createElement("div"),c.classList.add("spinner");break;case o:if(q.appendChild(h(b.device_list_title,a)),0==r.length){for(var e=0;e<b.no_device_msgs.length;e++){var j=document.createElement("p");j.appendChild(document.createTextNode(b.no_device_msgs[e])),q.appendChild(j)}var k=document.createElement("a");k.classList.add("play-store-button"),k.appendChild(document.createTextNode(b.play_store)),k.href="http://play.google.com/",q.appendChild(k)}else{q.appendChild(i());var m=document.createElement("ul");m.classList.add("device-list");for(var e=0;e<r.length;e++){var p=document.createElement("li");p.appendChild(document.createTextNode(r[e].name)),m.appendChild(p)}q.appendChild(m)}}null!=d&&q.classList.add(d),c&&q.appendChild(c),l=a}}var l,m,n=0,o=1,p={},q=document.getElementById("main-content"),r=[],s=!1;return p.init=function(a,b){console.log("home-ui-controller: init() token = "+a),m=a,s=b,"undefined"!=typeof m?(k(n),c.getDevices(m,function(a){r=a,k(o)},function(){})):require(["login-ui-controller"],function(a){console.log("home-ui-controller: loginController.init()"),a.init()})},p}),define("login-ui-controller",["config","strings","gplus-identity"],function(a,b,c){"use strict";function d(){for(var a=o.firstChild;a;)o.removeChild(a),a=o.firstChild;var b=e(h);null!=b&&o.classList.remove(b)}function e(a){switch(a){case l:return"sign-in";case k:return"loading";default:return null}}function f(a){var b=document.createElement("header"),c=document.createElement("h1");return c.innerHTML=a,b.appendChild(c),b}function g(a){if(h!=a){d();var c,n=e(a);switch(a){case l:var q=document.createElement("div");q.classList.add("spinner"),o.appendChild(q);var r=document.createElement("section");r.classList.add("sign-in-wrapper"),r.style.display="none",r.appendChild(f(b.welcome_title));for(var s=0;s<b.welcome_msgs.length;s++){var t=document.createElement("p");t.appendChild(document.createTextNode(b.welcome_msgs[s])),r.appendChild(t)}i.addSignInButton(r,function(a,b){j=a,p=b,g(m)},function(a){console.log("login-ui-controller - error on signing in "+a)},function(){var a=document.querySelector(".spinner"),b=document.querySelector(".sign-in-wrapper");a.style.display="none",b.style.display="block"}),o.appendChild(r);break;case k:c=document.createElement("div"),c.classList.add("spinner");break;case m:if("undefined"==typeof j||null===j)return g(l),void 0;window.location.hash="#home",require(["home-ui-controller"],function(a){a.init(j,p)})}null!=n&&o.classList.add(n),c&&o.appendChild(c),h=a}}var h,i,j,k=0,l=1,m=2,n={},o=document.getElementById("main-content"),p=!1;return n.init=function(){i=c,g(l)},n}),require.config({paths:{jquery:"../bower_components/jquery/jquery"}}),require(["login-ui-controller"],function(a){"use strict";a.init()}),define("main",function(){})}();